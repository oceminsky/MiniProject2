---
title: "Mini Project 2"
format:
  html: default
editor_options: 
  chunk_output_type: console
---
```{r}
library(tidyverse)
library(httr)
library(stringr)
library(polite)
```


```{r}
#set API up in the environment
Sys.setenv(nasa_key = "x3WHrXjNE5AO3wnyLuKV5FFP1IZIltHLh4Qjzln2")

nasa_api_key <- Sys.getenv("nasa_key")

url <- str_c("https://api.nasa.gov/insight_weather/?api_key=", nasa_api_key, "&feedtype=json&ver=1.0")

mars_weather <- GET(url)

details <- content(mars_weather, "parsed")

details[[1]]


```



```{r}
robotstxt::paths_allowed("https://www.ncaa.com/standings/basketball-men/d1")

session <- bow("https://www.ncaa.com/standings/basketball-men/d1", force = TRUE)

result <- scrape(session) |>
  html_nodes(css = "table") |>
  html_table(header = TRUE, fill = TRUE)

result
```

```{r}
acc_stats <- result[[1]]
be_stats <- result[[6]]
b10_stats <- result[[9]]
sec_stats <- result[[23]]
b12_stats <- result[[4]]


acc_stats |>
  row_to_names(row_number = 1) |>
  clean_names() |>
  rename(team = x, conference_wins = w, conference_losses = l, overall_wins = w_2, overall_losses = l_2) |>
  select(-starts_with("na"))

clean_tibble <- function(stats){
  stats |>
  row_to_names(row_number = 1) |>
  clean_names() |>
  rename(team = x, conference_wins = w, conference_losses = l, overall_wins = w_2, overall_losses = l_2) |>
  select(-starts_with("na"))
}


acc_tib <- clean_tibble(acc_stats)
be_tib <- clean_tibble(be_stats)
b10_tib <- clean_tibble(b10_stats)
sec_tib <- clean_tibble(sec_stats)
b12_tib <- clean_tibble(b12_stats)

acc_tib$conference <- "acc"
be_tib$conference <- "big east"
b10_tib$conference <- "big 10"
sec_tib$conference <- "sec"
b12_tib$conference <- "big 12"


ncaa_bb <- acc_tib |>
  bind_rows(be_tib, b10_tib, sec_tib, b12_tib)


ncaa_bb
```

